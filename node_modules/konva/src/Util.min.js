!function(){"use strict";Konva.Collection=function(){var e=[].slice.call(arguments),t=e.length,r=0;for(this.length=t;t>r;r++)this[r]=e[r];return this},Konva.Collection.prototype=[],Konva.Collection.prototype.each=function(e){for(var t=0;t<this.length;t++)e(this[t],t)},Konva.Collection.prototype.toArray=function(){var r,e=[],t=this.length;for(r=0;t>r;r++)e.push(this[r]);return e},Konva.Collection.toCollection=function(e){var i,t=new Konva.Collection,r=e.length;for(i=0;r>i;i++)t.push(e[i]);return t},Konva.Collection._mapMethod=function(e){Konva.Collection.prototype[e]=function(){var r,t=this.length,i=[].slice.call(arguments);for(r=0;t>r;r++)this[r][e].apply(this[r],i);return this}},Konva.Collection.mapMethods=function(e){var t=e.prototype;for(var r in t)Konva.Collection._mapMethod(r)},Konva.Transform=function(e){this.m=e&&e.slice()||[1,0,0,1,0,0]},Konva.Transform.prototype={copy:function(){return new Konva.Transform(this.m)},point:function(e){var t=this.m;return{x:t[0]*e.x+t[2]*e.y+t[4],y:t[1]*e.x+t[3]*e.y+t[5]}},translate:function(e,t){return this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t,this},scale:function(e,t){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t,this},rotate:function(e){var t=Math.cos(e),r=Math.sin(e),i=this.m[0]*t+this.m[2]*r,n=this.m[1]*t+this.m[3]*r,s=this.m[0]*-r+this.m[2]*t,a=this.m[1]*-r+this.m[3]*t;return this.m[0]=i,this.m[1]=n,this.m[2]=s,this.m[3]=a,this},getTranslation:function(){return{x:this.m[4],y:this.m[5]}},skew:function(e,t){var r=this.m[0]+this.m[2]*t,i=this.m[1]+this.m[3]*t,n=this.m[2]+this.m[0]*e,s=this.m[3]+this.m[1]*e;return this.m[0]=r,this.m[1]=i,this.m[2]=n,this.m[3]=s,this},multiply:function(e){var t=this.m[0]*e.m[0]+this.m[2]*e.m[1],r=this.m[1]*e.m[0]+this.m[3]*e.m[1],i=this.m[0]*e.m[2]+this.m[2]*e.m[3],n=this.m[1]*e.m[2]+this.m[3]*e.m[3],s=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],a=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=t,this.m[1]=r,this.m[2]=i,this.m[3]=n,this.m[4]=s,this.m[5]=a,this},invert:function(){var e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,r=-this.m[1]*e,i=-this.m[2]*e,n=this.m[0]*e,s=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=t,this.m[1]=r,this.m[2]=i,this.m[3]=n,this.m[4]=s,this.m[5]=a,this},getMatrix:function(){return this.m},setAbsolutePosition:function(e,t){var r=this.m[0],i=this.m[1],n=this.m[2],s=this.m[3],a=this.m[4],o=this.m[5],h=(r*(t-o)-i*(e-a))/(r*s-i*n),c=(e-a-n*h)/r;return this.translate(c,h)}};var e="2d",t="[object Array]",r="[object Number]",i="[object String]",n=Math.PI/180,s=180/Math.PI,a="#",o="",h="0",c="Konva warning: ",u="Konva error: ",l="rgb(",f={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},p=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;Konva.Util={_isElement:function(e){return!(!e||1!=e.nodeType)},_isFunction:function(e){return!!(e&&e.constructor&&e.call&&e.apply)},_isObject:function(e){return!!e&&e.constructor===Object},_isArray:function(e){return Object.prototype.toString.call(e)===t},_isNumber:function(e){return Object.prototype.toString.call(e)===r},_isString:function(e){return Object.prototype.toString.call(e)===i},_throttle:function(e,t,r){var i,n,s,a=null,o=0,h=r||{},c=function(){o=h.leading===!1?0:(new Date).getTime(),a=null,s=e.apply(i,n),i=n=null};return function(){var r=(new Date).getTime();o||h.leading!==!1||(o=r);var u=t-(r-o);return i=this,n=arguments,0>=u?(clearTimeout(a),a=null,o=r,s=e.apply(i,n),i=n=null):a||h.trailing===!1||(a=setTimeout(c,u)),s}},_hasMethods:function(e){var r,t=[];for(r in e)e.hasOwnProperty(r)&&this._isFunction(e[r])&&t.push(r);return t.length>0},isValidSelector:function(e){if("string"!=typeof e)return!1;var t=e[0];return"#"===t||"."===t||t===t.toUpperCase()},createCanvasElement:function(){var e=Konva.document.createElement("canvas");try{e.style=e.style||{}}catch(t){}return e},isBrowser:function(){return"object"!=typeof exports},_isInDocument:function(e){for(;e=e.parentNode;)if(e==Konva.document)return!0;return!1},_simplifyArray:function(e){var n,s,t=[],r=e.length,i=Konva.Util;for(n=0;r>n;n++)s=e[n],i._isNumber(s)?s=Math.round(1e3*s)/1e3:i._isString(s)||(s=s.toString()),t.push(s);return t},_getImage:function(t,r){var i,n;if(t)if(this._isElement(t))r(t);else if(this._isString(t))i=new Konva.window.Image,i.onload=function(){r(i)},i.src=t;else if(t.data){n=Konva.Util.createCanvasElement(),n.width=t.width,n.height=t.height;var s=n.getContext(e);s.putImageData(t,0,0),this._getImage(n.toDataURL(),r)}else r(null);else r(null)},_getRGBAString:function(e){var t=e.red||0,r=e.green||0,i=e.blue||0,n=e.alpha||1;return["rgba(",t,",",r,",",i,",",n,")"].join(o)},_rgbToHex:function(e,t,r){return((1<<24)+(e<<16)+(t<<8)+r).toString(16).slice(1)},_hexToRgb:function(e){e=e.replace(a,o);var t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},getRandomColor:function(){for(var e=(16777215*Math.random()<<0).toString(16);e.length<6;)e=h+e;return a+e},get:function(e,t){return void 0===e?t:e},getRGB:function(e){var t;return e in f?(t=f[e],{r:t[0],g:t[1],b:t[2]}):e[0]===a?this._hexToRgb(e.substring(1)):e.substr(0,4)===l?(t=p.exec(e.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA:function(e){return e=e||"black",Konva.Util._namedColorToRBA(e)||Konva.Util._hex3ColorToRGBA(e)||Konva.Util._hex6ColorToRGBA(e)||Konva.Util._rgbColorToRGBA(e)||Konva.Util._rgbaColorToRGBA(e)},_namedColorToRBA:function(e){var t=f[e.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA:function(e){if(0===e.indexOf("rgb(")){e=e.match(/rgb\(([^)]+)\)/)[1];var t=e.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA:function(e){if(0===e.indexOf("rgba(")){e=e.match(/rgba\(([^)]+)\)/)[1];var t=e.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex6ColorToRGBA:function(e){return"#"===e[0]&&7===e.length?{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:1}:void 0},_hex3ColorToRGBA:function(e){return"#"===e[0]&&4===e.length?{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:1}:void 0},_merge:function(e,t){var r=this._clone(t);for(var i in e)this._isObject(e[i])?r[i]=this._merge(e[i],r[i]):r[i]=e[i];return r},cloneObject:function(e){var t={};for(var r in e)this._isObject(e[r])?t[r]=this.cloneObject(e[r]):this._isArray(e[r])?t[r]=this.cloneArray(e[r]):t[r]=e[r];return t},cloneArray:function(e){return e.slice(0)},_degToRad:function(e){return e*n},_radToDeg:function(e){return e*s},_capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},"throw":function(e){throw new Error(u+e)},error:function(e){console.error(u+e)},warn:function(e){Konva.global.console&&console.warn&&Konva.showWarnings&&console.warn(c+e)},extend:function(e,t){function r(){this.constructor=e}r.prototype=t.prototype;var i=e.prototype;e.prototype=new r;for(var n in i)i.hasOwnProperty(n)&&(e.prototype[n]=i[n]);e.__super__=t.prototype,e["super"]=t},addMethods:function(e,t){var r;for(r in t)e.prototype[r]=t[r]},_getControlPoints:function(e,t,r,i,n,s,a){var o=Math.sqrt(Math.pow(r-e,2)+Math.pow(i-t,2)),h=Math.sqrt(Math.pow(n-r,2)+Math.pow(s-i,2)),c=a*o/(o+h),u=a*h/(o+h),l=r-c*(n-e),f=i-c*(s-t),p=r+u*(n-e),d=i+u*(s-t);return[l,f,p,d]},_expandPoints:function(e,t){var n,s,r=e.length,i=[];for(n=2;r-2>n;n+=2)s=Konva.Util._getControlPoints(e[n-2],e[n-1],e[n],e[n+1],e[n+2],e[n+3],t),i.push(s[0]),i.push(s[1]),i.push(e[n]),i.push(e[n+1]),i.push(s[2]),i.push(s[3]);return i},_removeLastLetter:function(e){return e.substring(0,e.length-1)},each:function(e,t){for(var r in e)t(r,e[r])},_getProjectionToSegment:function(e,t,r,i,n,s){var a,o,h,c=(e-r)*(e-r)+(t-i)*(t-i);if(0==c)a=e,o=t,h=(n-r)*(n-r)+(s-i)*(s-i);else{var u=((n-e)*(r-e)+(s-t)*(i-t))/c;0>u?(a=e,o=t,h=(e-n)*(e-n)+(t-s)*(t-s)):u>1?(a=r,o=i,h=(r-n)*(r-n)+(i-s)*(i-s)):(a=e+u*(r-e),o=t+u*(i-t),h=(a-n)*(a-n)+(o-s)*(o-s))}return[a,o,h]},_getProjectionToLine:function(e,t,r){var i=Konva.Util.cloneObject(e),n=Number.MAX_VALUE;return t.forEach(function(s,a){if(r||a!==t.length-1){var o=t[(a+1)%t.length],h=Konva.Util._getProjectionToSegment(s.x,s.y,o.x,o.y,e.x,e.y),c=h[0],u=h[1],l=h[2];n>l&&(i.x=c,i.y=u,n=l)}}),i},_prepareArrayForTween:function(e,t,r){var i,n=[],s=[];if(e.length>t.length){var a=t;t=e,e=a}for(i=0;i<e.length;i+=2)n.push({x:e[i],y:e[i+1]});for(i=0;i<t.length;i+=2)s.push({x:t[i],y:t[i+1]});var o=[];return s.forEach(function(e){var t=Konva.Util._getProjectionToLine(e,n,r);o.push(t.x),o.push(t.y)}),o},_prepareToStringify:function(e){var t;e.visitedByCircularReferenceRemoval=!0;for(var r in e)if(e.hasOwnProperty(r)&&e[r]&&"object"==typeof e[r])if(t=Object.getOwnPropertyDescriptor(e,r),e[r].visitedByCircularReferenceRemoval||Konva.Util._isElement(e[r])){if(!t.configurable)return null;delete e[r]}else if(null===Konva.Util._prepareToStringify(e[r])){if(!t.configurable)return null;delete e[r]}return delete e.visitedByCircularReferenceRemoval,e}}}();