function parse(t,e,n){n=n||{},e=e||exports.defaultState();for(var i=n.start||0,a=n.end||t.length,r=i;a>r;){if(e.roundDepth<0||e.curlyDepth<0||e.squareDepth<0)throw new SyntaxError("Mismatched Bracket: "+t[r-1]);exports.parseChar(t[r++],e)}return e}function parseMax(t,e){e=e||{};for(var n=e.start||0,i=n,a=exports.defaultState();a.roundDepth>=0&&a.curlyDepth>=0&&a.squareDepth>=0;){if(i>=t.length)throw new Error("The end of the string was reached with no closing bracket found.");exports.parseChar(t[i++],a)}var r=i-1;return{start:n,end:r,src:t.substring(n,r)}}function parseUntil(t,e,n){n=n||{};for(var i=n.includeLineComment||!1,a=n.start||0,r=a,o=exports.defaultState();o.isString()||o.regexp||o.blockComment||!i&&o.lineComment||!startsWith(t,e,r);)exports.parseChar(t[r++],o);var s=r;return{start:a,end:s,src:t.substring(a,s)}}function parseChar(t,e){if(1!==t.length)throw new Error("Character must be a string of length 1");e=e||exports.defaultState(),e.src=e.src||"",e.src+=t;var n=e.blockComment||e.lineComment,i=e.history?e.history[0]:"";return e.regexpStart&&(("/"===t||"*"==t)&&(e.regexp=!1),e.regexpStart=!1),e.lineComment?"\n"===t&&(e.lineComment=!1):e.blockComment?"*"===e.lastChar&&"/"===t&&(e.blockComment=!1):e.singleQuote?"'"!==t||e.escaped?"\\"!==t||e.escaped?e.escaped=!1:e.escaped=!0:e.singleQuote=!1:e.doubleQuote?'"'!==t||e.escaped?"\\"!==t||e.escaped?e.escaped=!1:e.escaped=!0:e.doubleQuote=!1:e.regexp?"/"!==t||e.escaped?"\\"!==t||e.escaped?e.escaped=!1:e.escaped=!0:e.regexp=!1:"/"===i&&"/"===t?(e.history=e.history.substr(1),e.lineComment=!0):"/"===i&&"*"===t?(e.history=e.history.substr(1),e.blockComment=!0):"/"===t&&isRegexp(e.history)?(e.regexp=!0,e.regexpStart=!0):"'"===t?e.singleQuote=!0:'"'===t?e.doubleQuote=!0:"("===t?e.roundDepth++:")"===t?e.roundDepth--:"{"===t?e.curlyDepth++:"}"===t?e.curlyDepth--:"["===t?e.squareDepth++:"]"===t&&e.squareDepth--,e.blockComment||e.lineComment||n||(e.history=t+e.history),e.lastChar=t,e}function State(){this.lineComment=!1,this.blockComment=!1,this.singleQuote=!1,this.doubleQuote=!1,this.regexp=!1,this.escaped=!1,this.roundDepth=0,this.curlyDepth=0,this.squareDepth=0,this.history="",this.lastChar=""}function startsWith(t,e,n){return t.substr(n||0,e.length)===e}function isPunctuator(t){if(!t)return!0;var e=t.charCodeAt(0);switch(e){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:case 37:case 38:case 42:case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 33:case 61:return!0;default:return!1}}function isKeyword(t){return"if"===t||"in"===t||"do"===t||"var"===t||"for"===t||"new"===t||"try"===t||"let"===t||"this"===t||"else"===t||"case"===t||"void"===t||"with"===t||"enum"===t||"while"===t||"break"===t||"catch"===t||"throw"===t||"const"===t||"yield"===t||"class"===t||"super"===t||"return"===t||"typeof"===t||"delete"===t||"switch"===t||"export"===t||"import"===t||"default"===t||"finally"===t||"extends"===t||"function"===t||"continue"===t||"debugger"===t||"package"===t||"private"===t||"interface"===t||"instanceof"===t||"implements"===t||"protected"===t||"public"===t||"static"===t||"yield"===t||"let"===t}function isRegexp(t){return t=t.replace(/^\s*/,""),")"===t[0]?!1:"}"===t[0]?!0:isPunctuator(t[0])?!0:/^\w+\b/.test(t)&&isKeyword(/^\w+\b/.exec(t)[0].split("").reverse().join(""))?!0:!1}exports=module.exports=parse,exports.parse=parse,exports.parseMax=parseMax,exports.parseUntil=parseUntil,exports.parseChar=parseChar,exports.defaultState=function(){return new State},State.prototype.isString=function(){return this.singleQuote||this.doubleQuote},State.prototype.isComment=function(){return this.lineComment||this.blockComment},State.prototype.isNesting=function(){return this.isString()||this.isComment()||this.regexp||this.roundDepth>0||this.curlyDepth>0||this.squareDepth>0},exports.isPunctuator=isPunctuator,exports.isKeyword=isKeyword;