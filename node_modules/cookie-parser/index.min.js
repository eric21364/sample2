"use strict";function cookieParser(t,e){return function(n,i,r){if(n.cookies)return r();var a=n.headers.cookie,o=!t||Array.isArray(t)?t||[]:[t];return n.secret=o[0],n.cookies=Object.create(null),n.signedCookies=Object.create(null),a?(n.cookies=cookie.parse(a,e),0!==o.length&&(n.signedCookies=signedCookies(n.cookies,o),n.signedCookies=JSONCookies(n.signedCookies)),n.cookies=JSONCookies(n.cookies),void r()):r()}}function JSONCookie(t){if("string"!=typeof t||"j:"!==t.substr(0,2))return void 0;try{return JSON.parse(t.slice(2))}catch(e){return void 0}}function JSONCookies(t){for(var n,i,e=Object.keys(t),r=0;r<e.length;r++)n=e[r],i=JSONCookie(t[n]),i&&(t[n]=i);return t}function signedCookie(t,e){if("string"!=typeof t)return void 0;if("s:"!==t.substr(0,2))return t;for(var n=!e||Array.isArray(e)?e||[]:[e],i=0;i<n.length;i++){var r=signature.unsign(t.slice(2),n[i]);if(r!==!1)return r}return!1}function signedCookies(t,e){for(var i,r,o,n=Object.keys(t),a=Object.create(null),s=0;s<n.length;s++)r=n[s],o=t[r],i=signedCookie(o,e),o!==i&&(a[r]=i,delete t[r]);return a}var cookie=require("cookie"),signature=require("cookie-signature");module.exports=cookieParser,module.exports.JSONCookie=JSONCookie,module.exports.JSONCookies=JSONCookies,module.exports.signedCookie=signedCookie,module.exports.signedCookies=signedCookies;