"use strict";function parseAcceptLanguage(e){for(var t=e.split(","),r=0,i=0;r<t.length;r++){var n=parseLanguage(t[r].trim(),r);n&&(t[i++]=n)}return t.length=i,t}function parseLanguage(e,t){var r=simpleLanguageRegExp.exec(e);if(!r)return null;var i=r[1],n=r[2],s=i;n&&(s+="-"+n);var a=1;if(r[3])for(var o=r[3].split(";"),t=0;t<o.length;t++){var c=o[t].split("=");"q"===c[0]&&(a=parseFloat(c[1]))}return{prefix:i,suffix:n,q:a,i:t,full:s}}function getLanguagePriority(e,t,r){for(var i={o:-1,q:0,s:0},n=0;n<t.length;n++){var s=specify(e,t[n],r);s&&(i.s-s.s||i.q-s.q||i.o-s.o)<0&&(i=s)}return i}function specify(e,t,r){var i=parseLanguage(e);if(!i)return null;var n=0;if(t.full.toLowerCase()===i.full.toLowerCase())n|=4;else if(t.prefix.toLowerCase()===i.full.toLowerCase())n|=2;else if(t.full.toLowerCase()===i.prefix.toLowerCase())n|=1;else if("*"!==t.full)return null;return{i:r,o:t.i,q:t.q,s:n}}function preferredLanguages(e,t){var r=parseAcceptLanguage(void 0===e?"*":e||"");if(!t)return r.filter(isQuality).sort(compareSpecs).map(getFullLanguage);var i=t.map(function(e,t){return getLanguagePriority(e,r,t)});return i.filter(isQuality).sort(compareSpecs).map(function(e){return t[i.indexOf(e)]})}function compareSpecs(e,t){return t.q-e.q||t.s-e.s||e.o-t.o||e.i-t.i||0}function getFullLanguage(e){return e.full}function isQuality(e){return e.q>0}module.exports=preferredLanguages,module.exports.preferredLanguages=preferredLanguages;var simpleLanguageRegExp=/^\s*([^\s\-;]+)(?:-([^\s;]+))?\s*(?:;(.*))?$/;