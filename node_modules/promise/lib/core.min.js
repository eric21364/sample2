"use strict";function Promise(e){function s(e){return null===t?void i.push(e):void asap(function(){var i=t?e.onFulfilled:e.onRejected;if(null===i)return void(t?e.resolve:e.reject)(r);var n;try{n=i(r)}catch(s){return void e.reject(s)}e.resolve(n)})}function a(e){try{if(e===n)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var i=e.then;if("function"==typeof i)return void doResolve(i.bind(e),a,o)}t=!0,r=e,u()}catch(s){o(s)}}function o(e){t=!1,r=e,u()}function u(){for(var e=0,t=i.length;t>e;e++)s(i[e]);i=null}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");var t=null,r=null,i=[],n=this;this.then=function(e,t){return new n.constructor(function(r,i){s(new Handler(e,t,r,i))})},doResolve(e,a,o)}function Handler(e,t,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=r,this.reject=i}function doResolve(e,t,r){var i=!1;try{e(function(e){i||(i=!0,t(e))},function(e){i||(i=!0,r(e))})}catch(n){if(i)return;i=!0,r(n)}}var asap=require("asap");module.exports=Promise;