var mkdirp=require("../").mkdirp,path=require("path"),fs=require("fs"),exists=fs.exists||path.exists,test=require("tap").test,_0777=parseInt("0777",8),_0755=parseInt("0755",8);test("race",function(e){function a(t,r){mkdirp(t,_0755,function(r){e.ifError(r),exists(t,function(r){e.ok(r,"file created"),fs.stat(t,function(t,r){e.ifError(t),e.equal(r.mode&_0777,_0755),e.ok(r.isDirectory(),"target not a directory")})})})}e.plan(10);for(var t=["","tmp"],r=0;25>r;r++){var i=Math.floor(Math.random()*Math.pow(16,4)).toString(16);t.push(i)}var n=t.join("/");a(n),a(n)});