"use strict";function ValuePromise(e){this.then=function(t){return"function"!=typeof t?this:new Promise(function(r,i){asap(function(){try{r(t(e))}catch(n){i(n)}})})}}var Promise=require("./core.js"),asap=require("asap");module.exports=Promise,ValuePromise.prototype=Promise.prototype;var TRUE=new ValuePromise(!0),FALSE=new ValuePromise(!1),NULL=new ValuePromise(null),UNDEFINED=new ValuePromise(void 0),ZERO=new ValuePromise(0),EMPTYSTRING=new ValuePromise("");Promise.resolve=function(e){if(e instanceof Promise)return e;if(null===e)return NULL;if(void 0===e)return UNDEFINED;if(e===!0)return TRUE;if(e===!1)return FALSE;if(0===e)return ZERO;if(""===e)return EMPTYSTRING;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new Promise(t.bind(e))}catch(r){return new Promise(function(e,t){t(r)})}return new ValuePromise(e)},Promise.all=function(e){var t=Array.prototype.slice.call(e);return new Promise(function(e,r){function n(s,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var o=a.then;if("function"==typeof o)return void o.call(a,function(e){n(s,e)},r)}t[s]=a,0===--i&&e(t)}catch(u){r(u)}}if(0===t.length)return e([]);for(var i=t.length,s=0;s<t.length;s++)n(s,t[s])})},Promise.reject=function(e){return new Promise(function(t,r){r(e)})},Promise.race=function(e){return new Promise(function(t,r){e.forEach(function(e){Promise.resolve(e).then(t,r)})})},Promise.prototype["catch"]=function(e){return this.then(null,e)};