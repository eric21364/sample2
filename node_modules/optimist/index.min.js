function Argv(t,e){function o(t){n.showHelp(),t&&console.error(t),process.exit(1)}function f(){function s(t,n){var a=Number(n),s="string"!=typeof n||isNaN(a)?n:a;r.strings[t]&&(s=n),setKey(e,t.split("."),s),(i[t]||[]).forEach(function(n){e[n]=e[t]})}var e={_:[],$0:n.$0};Object.keys(r.bools).forEach(function(t){s(t,c[t]||!1)});for(var u=0;u<t.length;u++){var l=t[u];if("--"===l){e._.push.apply(e._,t.slice(u+1));break}if(l.match(/^--.+=/)){var f=l.match(/^--([^=]+)=([\s\S]*)$/);s(f[1],f[2])}else if(l.match(/^--no-.+/)){var p=l.match(/^--no-(.+)/)[1];s(p,!1)}else if(l.match(/^--.+/)){var p=l.match(/^--(.+)/)[1],d=t[u+1];void 0===d||d.match(/^-/)||r.bools[p]||(i[p]?r.bools[i[p]]:0)?/^(true|false)$/.test(d)?(s(p,"true"===d),u++):s(p,!0):(s(p,d),u++)}else if(l.match(/^-[^-]+/)){for(var v=l.slice(1,-1).split(""),g=!1,m=0;m<v.length;m++){if(v[m+1]&&v[m+1].match(/\W/)){s(v[m],l.slice(m+2)),g=!0;break}s(v[m],!0)}if(!g){var p=l.slice(-1)[0];!t[u+1]||t[u+1].match(/^-/)||r.bools[p]||(i[p]?r.bools[i[p]]:0)?t[u+1]&&/true|false/.test(t[u+1])?(s(p,"true"===t[u+1]),u++):s(p,!0):(s(p,t[u+1]),u++)}}else{var y=Number(l);e._.push(r.strings._||isNaN(y)?l:y)}}Object.keys(c).forEach(function(t){t in e||(e[t]=c[t],t in i&&(e[i[t]]=c[t]))}),a._&&e._.length<a._&&o("Not enough non-option arguments: got "+e._.length+", need at least "+a._);var b=[];return Object.keys(a).forEach(function(t){e[t]||b.push(t)}),b.length&&o("Missing required arguments: "+b.join(", ")),h.forEach(function(t){try{t(e)===!1&&o("Argument check failed: "+t.toString())}catch(n){o(n)}}),e}function p(t){return Math.max.apply(null,t.map(function(t){return t.length}))}var n={};e||(e=process.cwd()),n.$0=process.argv.slice(0,2).map(function(t){var n=rebase(e,t);return t.match(/^\//)&&n.length<t.length?n:t}).join(" "),void 0!=process.env._&&process.argv[1]==process.env._&&(n.$0=process.env._.replace(path.dirname(process.execPath)+"/",""));var r={bools:{},strings:{}};n["boolean"]=function(t){return Array.isArray(t)||(t=[].slice.call(arguments)),t.forEach(function(t){r.bools[t]=!0}),n},n.string=function(t){return Array.isArray(t)||(t=[].slice.call(arguments)),t.forEach(function(t){r.strings[t]=!0}),n};var i={};n.alias=function(t,e){if("object"==typeof t)Object.keys(t).forEach(function(e){n.alias(e,t[e])});else if(Array.isArray(e))e.forEach(function(e){n.alias(t,e)});else{var r=(i[t]||[]).concat(i[e]||[]).concat(t,e);i[t]=r.filter(function(e){return e!=t}),i[e]=r.filter(function(t){return t!=e})}return n};var a={};n.demand=function(t){return"number"==typeof t?(a._||(a._=0),a._+=t):Array.isArray(t)?t.forEach(function(t){n.demand(t)}):a[t]=!0,n};var s;n.usage=function(t,e){return e||"object"!=typeof t||(e=t,t=null),s=t,e&&n.options(e),n};var h=[];n.check=function(t){return h.push(t),n};var c={};n["default"]=function(t,e){return"object"==typeof t?Object.keys(t).forEach(function(e){n["default"](e,t[e])}):c[t]=e,n};var u={};n.describe=function(t,e){return"object"==typeof t?Object.keys(t).forEach(function(e){n.describe(e,t[e])}):u[t]=e,n},n.parse=function(t){return Argv(t).argv},n.option=n.options=function(t,e){if("object"==typeof t)Object.keys(t).forEach(function(e){n.options(e,t[e])});else{e.alias&&n.alias(t,e.alias),e.demand&&n.demand(t),"undefined"!=typeof e["default"]&&n["default"](t,e["default"]),(e["boolean"]||"boolean"===e.type)&&n["boolean"](t),(e.string||"string"===e.type)&&n.string(t);var r=e.describe||e.description||e.desc;r&&n.describe(t,r)}return n};var l=null;return n.wrap=function(t){return l=t,n},n.showHelp=function(t){t||(t=console.error),t(n.help())},n.help=function(){var t=Object.keys(Object.keys(u).concat(Object.keys(a)).concat(Object.keys(c)).reduce(function(t,e){return"_"!==e&&(t[e]=!0),t},{})),e=t.length?["Options:"]:[];s&&e.unshift(s.replace(/\$0/g,n.$0),"");var o=t.reduce(function(t,e){return t[e]=[e].concat(i[e]||[]).map(function(t){return(t.length>1?"--":"-")+t}).join(", "),t},{}),h=p(Object.keys(o).map(function(t){return o[t]||""})),f=p(Object.keys(u).map(function(t){return u[t]||""}));return t.forEach(function(t){var n=o[t],i=u[t]||"";l&&(i=wordwrap(h+4,l)(i).slice(h+4));var s=new Array(Math.max(h-n.length+3,0)).join(" "),p=new Array(Math.max(f-i.length+1,0)).join(" "),d=null;r.bools[t]&&(d="[boolean]"),r.strings[t]&&(d="[string]"),!l&&p.length>0&&(i+=p);var v="  "+n+s,g=[d,a[t]?"[required]":null,void 0!==c[t]?"[default: "+JSON.stringify(c[t])+"]":null].filter(Boolean).join("  "),m=[i,g].filter(Boolean).join("  ");if(l){var y=i.split("\n"),b=y.slice(-1)[0].length+(1===y.length?v.length:0);m=i+(b+g.length>l-2?"\n"+new Array(l-g.length+1).join(" ")+g:new Array(l-g.length-b+1).join(" ")+g)}e.push(v+m)}),e.push(""),e.join("\n")},Object.defineProperty(n,"argv",{get:f,enumerable:!0}),n}function rebase(t,e){for(var n=path.normalize(e).split("/").slice(1),r=path.normalize(t).split("/").slice(1),i=0;n[i]&&n[i]==r[i];i++);n.splice(0,i),r.splice(0,i);var a=path.normalize(r.map(function(){return".."}).concat(n).join("/")).replace(/\/$/,"").replace(/^$/,".");return a.match(/^[.\/]/)?a:"./"+a}function setKey(t,e,n){var r=t;e.slice(0,-1).forEach(function(t){void 0===r[t]&&(r[t]={}),r=r[t]});var i=e[e.length-1];void 0===r[i]||"boolean"==typeof r[i]?r[i]=n:Array.isArray(r[i])?r[i].push(n):r[i]=[r[i],n]}var path=require("path"),wordwrap=require("wordwrap"),inst=Argv(process.argv.slice(2));Object.keys(inst).forEach(function(t){Argv[t]="function"==typeof inst[t]?inst[t].bind(inst):inst[t]});var exports=module.exports=Argv;exports.rebase=rebase;