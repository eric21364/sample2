"use strict";function parseAcceptCharset(e){for(var t=e.split(","),r=0,i=0;r<t.length;r++){var n=parseCharset(t[r].trim(),r);n&&(t[i++]=n)}return t.length=i,t}function parseCharset(e,t){var r=simpleCharsetRegExp.exec(e);if(!r)return null;var i=r[1],n=1;if(r[2])for(var s=r[2].split(";"),t=0;t<s.length;t++){var a=s[t].trim().split("=");if("q"===a[0]){n=parseFloat(a[1]);break}}return{charset:i,q:n,i:t}}function getCharsetPriority(e,t,r){for(var i={o:-1,q:0,s:0},n=0;n<t.length;n++){var s=specify(e,t[n],r);s&&(i.s-s.s||i.q-s.q||i.o-s.o)<0&&(i=s)}return i}function specify(e,t,r){var i=0;if(t.charset.toLowerCase()===e.toLowerCase())i|=1;else if("*"!==t.charset)return null;return{i:r,o:t.i,q:t.q,s:i}}function preferredCharsets(e,t){var r=parseAcceptCharset(void 0===e?"*":e||"");if(!t)return r.filter(isQuality).sort(compareSpecs).map(getFullCharset);var i=t.map(function(e,t){return getCharsetPriority(e,r,t)});return i.filter(isQuality).sort(compareSpecs).map(function(e){return t[i.indexOf(e)]})}function compareSpecs(e,t){return t.q-e.q||t.s-e.s||e.o-t.o||e.i-t.i||0}function getFullCharset(e){return e.charset}function isQuality(e){return e.q>0}module.exports=preferredCharsets,module.exports.preferredCharsets=preferredCharsets;var simpleCharsetRegExp=/^\s*([^\s;]+)\s*(?:;(.*))?$/;