function UI(t){this.width=t.width,this.wrap=t.wrap,this.rows=[]}function _minWidth(t){var e=t.padding||[];return 1+(e[left]||0)+(e[right]||0)}var wrap=require("wordwrap"),align={right:require("right-align"),center:require("center-align")},top=0,right=1,bottom=2,left=3;UI.prototype.span=function(){var t=this.div.apply(this,arguments);t.span=!0},UI.prototype.div=function(){if(0===arguments.length&&this.div(""),this.wrap&&this._shouldApplyLayoutDSL.apply(this,arguments))return this._applyLayoutDSL(arguments[0]);for(var n,t=[],e=0;void 0!==(n=arguments[e]);e++)"string"==typeof n?t.push(this._colFromString(n)):t.push(n);return this.rows.push(t),t},UI.prototype._shouldApplyLayoutDSL=function(){return 1===arguments.length&&"string"==typeof arguments[0]&&/[\t\n]/.test(arguments[0])},UI.prototype._applyLayoutDSL=function(t){var e=this,n=t.split("\n"),i=0;return n.forEach(function(t){var n=t.split("	");n.length>1&&n[0].length>i&&(i=Math.min(Math.floor(.5*e.width),n[0].length))}),n.forEach(function(t){var n=t.split("	");e.div.apply(e,n.map(function(t,e){return{text:t.trim(),padding:[0,t.match(/\s*$/)[0].length,0,t.match(/^\s*/)[0].length],width:0===e&&n.length>1?i:void 0}}))}),this.rows[this.rows.length-1]},UI.prototype._colFromString=function(t){return{text:t}},UI.prototype.toString=function(){var t=this,e=[];return t.rows.forEach(function(n,i){t.rowToString(n,e)}),e=e.filter(function(t){return!t.hidden}),e.map(function(t){return t.text}).join("\n")},UI.prototype.rowToString=function(t,e){var i,o,s,h,n=this,a=this._rasterize(t),r="";return a.forEach(function(a,l){r="",a.forEach(function(a,c){o="",s=t[c].width,h=n._negatePadding(t[c]);for(var u=0;u<Math.max(h,a.length);u++)o+=a.charAt(u)||" ";t[c].align&&"left"!==t[c].align&&n.wrap&&(o=align[t[c].align](o.trim()+"\n"+new Array(h+1).join(" ")).split("\n")[0],o.length<h&&(o+=new Array(s-o.length).join(" "))),i=(t[c].padding||[0,0,0,0])[left],i&&(r+=new Array(t[c].padding[left]+1).join(" ")),r+=o,t[c].padding&&t[c].padding[right]&&(r+=new Array(t[c].padding[right]+1).join(" ")),0===l&&e.length>0&&(r=n._renderInline(r,e[e.length-1],i))}),e.push({text:r.replace(/ +$/,""),span:t.span})}),e},UI.prototype._renderInline=function(t,e,n){var i=e.text,a="";if(!e.span)return t;if(!this.wrap)return e.hidden=!0,i+t;for(var o,s,r=0;r<Math.max(t.length,i.length);r++){if(o=i.charAt(r)||" ",s=t.charAt(r)||" "," "!==o&&" "!==s)return t;if(" "!==s&&r<n+i.length)return t;a+=" "===o?s:o}return e.hidden=!0,a},UI.prototype._rasterize=function(t){var n,i,o,e=this,a=[],r=this._columnWidths(t);return t.forEach(function(t,s){if(t.width=r[s],o=e.wrap?wrap.hard(e._negatePadding(t))(t.text).split("\n"):t.text.split("\n"),t.padding){for(n=0;n<(t.padding[top]||0);n++)o.unshift("");for(n=0;n<(t.padding[bottom]||0);n++)o.push("")}o.forEach(function(t,e){a[e]||a.push([]),i=a[e];for(var n=0;s>n;n++)void 0===i[n]&&i.push("");i.push(t)})}),a},UI.prototype._negatePadding=function(t){var e=t.width;return t.padding&&(e-=(t.padding[left]||0)+(t.padding[right]||0)),e},UI.prototype._columnWidths=function(t){var a,e=this,n=[],i=t.length,r=this.width;return t.forEach(function(t,e){t.width?(i--,n[e]=t.width,r-=t.width):n[e]=void 0}),i&&(a=Math.floor(r/i)),n.forEach(function(i,r){e.wrap?void 0===i&&(n[r]=Math.max(a,_minWidth(t[r]))):n[r]=t[r].width||t[r].text.length}),n},module.exports=function(t){return t=t||{},new UI({width:(t||{}).width||80,wrap:"boolean"==typeof t.wrap?t.wrap:!0})};